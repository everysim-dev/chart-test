"use client"; // Client Component 선언

import React from "react";
import { Line } from "react-chartjs-2";
import {
  Chart,
  CategoryScale,
  LinearScale,
  PointElement,
  LineElement,
  Title,
  Tooltip,
  Legend,
  ChartOptions,
  ScatterDataPoint,
} from "chart.js";
import annotationPlugin from "chartjs-plugin-annotation";

Chart.register(
  CategoryScale,
  LinearScale,
  PointElement,
  LineElement,
  Title,
  Tooltip,
  Legend,
  annotationPlugin
); // Chart.js 모듈 등록

const data0ms: ScatterDataPoint[] = [
  { x: 1275.029605, y: 0.279350457 },
  { x: 1410.64559, y: 0.309935181 },
  { x: 1546.261574, y: 0.338167234 },
  { x: 1681.877559, y: 0.368751958 },
  { x: 1817.493544, y: 0.407963142 },
  { x: 1953.109528, y: 0.471485261 },
  { x: 2088.725513, y: 0.531086261 },
  { x: 2224.341498, y: 0.592255709 },
  { x: 2359.957483, y: 0.653425156 },
  { x: 2495.573467, y: 0.714594604 },
  { x: 2631.189452, y: 0.77341138 },
  { x: 2766.805437, y: 0.841638841 },
  { x: 2902.421421, y: 0.910650526 },
  { x: 3038.037406, y: 0.982014881 },
  { x: 3173.653391, y: 1.064358369 },
  { x: 3309.269375, y: 1.164739001 },
  { x: 3444.88536, y: 1.258845843 },
  { x: 3580.501345, y: 1.361579146 },
  { x: 3716.117329, y: 1.485486489 },
  { x: 3851.733314, y: 1.608609608 },
  { x: 3987.349299, y: 1.734085398 },
  { x: 4122.965284, y: 1.852503175 },
  { x: 4258.581268, y: 1.982684307 },
  { x: 4394.197253, y: 2.110512768 },
  { x: 4529.813238, y: 2.243046571 },
  { x: 4665.429222, y: 2.377933046 },
  { x: 4801.045207, y: 2.516740638 },
  { x: 4936.661192, y: 2.679859165 },
  { x: 5072.277176, y: 2.846741966 },
  { x: 5201.728798, y: 3.009259255 },
  { x: 5318.851694, y: 3.213131273 },
  { x: 5429.810227, y: 3.40195491 },
  { x: 5553.097486, y: 3.604122797 },
  { x: 5688.71347, y: 3.783261894 },
  { x: 5824.329455, y: 3.966844925 },
  { x: 5953.781077, y: 4.125120684 },
  { x: 6083.232699, y: 4.30853492 },
  { x: 6206.519957, y: 4.480581979 },
  { x: 6317.47849, y: 4.673878595 },
  { x: 6428.437023, y: 4.862565304 },
  { x: 6533.231193, y: 5.064585372 },
  { x: 6650.354089, y: 5.271718453 },
  { x: 6709.531973, y: 5.424188965 },
  { x: 6773.641348, y: 5.70044234 },
  { x: 6909.257333, y: 5.851259758 },
  { x: 7044.873317, y: 5.984577785 },
  { x: 7131.174399, y: 6.033983878 },
];

const data10ms: ScatterDataPoint[] = [
  { x: 2914.750147, y: -0.16508031 },
  { x: 3050.366132, y: -0.091195235 },
  { x: 3185.982117, y: 0.015235122 },
  { x: 3321.598101, y: 0.085087047 },
  { x: 3457.214086, y: 0.154709305 },
  { x: 3592.830071, y: 0.23241467 },
  { x: 3728.446055, y: 0.304669679 },
  { x: 3864.06204, y: 0.429226807 },
  { x: 3999.678025, y: 0.50961347 },
  { x: 4135.294009, y: 0.611861301 },
  { x: 4270.909994, y: 0.701733335 },
  { x: 4406.525979, y: 0.805564552 },
  { x: 4542.141963, y: 0.916700251 },
  { x: 4677.757948, y: 1.024512336 },
  { x: 4813.373933, y: 1.213360869 },
  { x: 4930.496829, y: 1.365990405 },
  { x: 5047.619725, y: 1.51409945 },
  { x: 5183.235709, y: 1.693305766 },
  { x: 5312.687331, y: 1.862227548 },
  { x: 5442.138953, y: 2.02047642 },
  { x: 5577.754938, y: 2.173250663 },
  { x: 5713.370922, y: 2.334173364 },
  { x: 5848.986907, y: 2.472824112 },
  { x: 5978.438529, y: 2.657587213 },
  { x: 6109.944938, y: 2.821739857 },
  { x: 6206.519957, y: 3.03936971 },
  { x: 6298.985402, y: 3.227149271 },
  { x: 6397.054812, y: 3.41697715 },
  { x: 6459.258838, y: 3.655477001 },
  { x: 6532.757012, y: 3.892673594 },
  { x: 6662.682815, y: 4.124660606 },
  { x: 6785.970074, y: 4.319866952 },
  { x: 6921.586059, y: 4.494552779 },
  { x: 7057.202043, y: 4.679629569 },
  { x: 7155.83185, y: 4.757267714 },
];

const data16ms: ScatterDataPoint[] = [
  { x: 4488.423944, y: -0.552934939 },
  { x: 4616.114319, y: -0.431156204 },
  { x: 4748.885213, y: -0.293856734 },
  { x: 4883.236713, y: -0.157658193 },
  { x: 5022.962273, y: -0.047670821 },
  { x: 5158.578258, y: 0.088784101 },
  { x: 5294.194242, y: 0.214259891 },
  { x: 5429.810227, y: 0.347577918 },
  { x: 5565.426212, y: 0.4628588 },
  { x: 5701.042196, y: 0.618919314 },
  { x: 5839.740362, y: 0.765373088 },
  { x: 5959.94544, y: 0.997089403 },
  { x: 6052.410884, y: 1.158595915 },
  { x: 6161.314629, y: 1.479212699 },
  { x: 6137.479093, y: 1.300644966 },
  { x: 6261.999224, y: 1.542832846 },
  { x: 6354.464668, y: 1.70843008 },
  { x: 6453.094475, y: 1.891714359 },
  { x: 6576.381734, y: 2.082106443 },
  { x: 6697.614205, y: 2.283630147 },
  { x: 6801.821293, y: 2.399779277 },
  { x: 6896.928607, y: 2.598735582 },
  { x: 7020.215866, y: 2.800629613 },
  { x: 7149.667487, y: 2.997469759 },
  { x: 7274.715993, y: 3.178625431 },
  { x: 7377.748916, y: 3.454672169 },
  { x: 7473.639006, y: 3.67320917 },
  { x: 7531.85799, y: 3.807278744 },
  { x: 7624.323434, y: 4.041271487 },
  { x: 7731.994306, y: 4.268434949 },
  { x: 7840.076137, y: 4.502787127 },
  { x: 7923.295036, y: 4.678910697 },
  { x: 8031.171388, y: 4.922402816 },
  { x: 8111.308106, y: 5.105776721 },
];

const data20ms: ScatterDataPoint[] = [
  { x: 5540.76876, y: -1.064808943 },
  { x: 5678.439532, y: -0.996102235 },
  { x: 5806.924195, y: -0.817658542 },
  { x: 5935.287988, y: -0.610631396 },
  { x: 6068.058882, y: -0.473685258 },
  { x: 6175.698143, y: -0.313653355 },
  { x: 6274.32795, y: -0.150572172 },
  { x: 6385.286483, y: 0.058003321 },
  { x: 6471.587564, y: 0.232689148 },
  { x: 6567.751626, y: 0.391416022 },
  { x: 6668.847178, y: 0.625193104 },
  { x: 6748.983896, y: 0.797722315 },
  { x: 6841.44934, y: 0.988928498 },
  { x: 6952.407873, y: 1.204244269 },
  { x: 7038.708954, y: 1.388794613 },
  { x: 7137.338761, y: 1.543418213 },
  { x: 7248.297294, y: 1.756337745 },
  { x: 7359.255827, y: 1.958843907 },
  { x: 7457.885634, y: 2.140574676 },
  { x: 7531.85799, y: 2.298726453 },
  { x: 7630.487797, y: 2.494916813 },
  { x: 7741.44633, y: 2.707405022 },
  { x: 7858.569226, y: 2.921487197 },
];

const Graph: React.FC = () => {
  // 플러그인 등록
  Chart.register(annotationPlugin);

  const data = {
    datasets: [
      {
        label: "0 m/s",
        data: data0ms,
        backgroundColor: "rgba(255, 99, 132, 0.2)",
        borderColor: "rgba(255, 99, 132, 1)",
        borderWidth: 2,
        showLine: true,
        pointRadius: 3,
        pointHoverRadius: 6,
        pointStyle: "circle", // 동그라미
      },
      {
        label: "10 m/s",
        data: data10ms,
        backgroundColor: "rgba(54, 162, 235, 0.2)",
        borderColor: "rgba(54, 162, 235, 1)",
        borderWidth: 2,
        showLine: true,
        pointRadius: 3,
        pointHoverRadius: 6,
        pointStyle: "rect", // 네모
      },
      {
        label: "16 m/s",
        data: data16ms,
        backgroundColor: "rgba(75, 192, 192, 0.2)",
        borderColor: "rgba(75, 192, 192, 1)",
        borderWidth: 2,
        showLine: true,
        pointRadius: 3,
        pointHoverRadius: 6,
        pointStyle: "triangle", // 세모
      },
      {
        label: "20 m/s",
        data: data20ms,
        backgroundColor: "rgba(153, 102, 255, 0.2)",
        borderColor: "rgba(153, 102, 255, 1)",
        borderWidth: 2,
        showLine: true,
        pointRadius: 3,
        pointHoverRadius: 6,
        pointStyle: "cross", // 엑스
      },
    ],
  };

  const options: ChartOptions<"line"> = {
    maintainAspectRatio: false, // 비율 유지 비활성화
    scales: {
      x: {
        type: "linear",
        position: "bottom",
        title: {
          display: true,
          text: "RPM [rev/min]",
          font: {
            size: 16,
            weight: "bold",
          },
        },
        grid: {
          color: "rgba(200, 200, 200, 0.3)",
        },
        ticks: {
          color: "#333",
        },
      },
      y: {
        type: "linear",
        title: {
          display: true,
          text: "Thrust [N]",
          font: {
            size: 16,
            weight: "bold",
          },
        },
        grid: {
          color: "rgba(200, 200, 200, 0.3)",
        },
        ticks: {
          color: "#333",
        },
      },
    },
    plugins: {
      legend: {
        position: "top",
        labels: {
          usePointStyle: true, // 레전드에 표식 반영
          font: {
            size: 12,
          },
        },
      },
      title: {
        display: true,
        text: "Thrust vs. RPM",
        font: {
          size: 20,
          weight: "bold",
        },
      },
    },
  };

  return (
    <div className="h-screen flex items-center justify-center">
      <div className="w-full max-w-4xl h-[700px]">
        <Line data={data} options={options} />
      </div>
    </div>
  );
};

export default Graph;
